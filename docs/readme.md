# Цель:

- Цель-минимум: наладить процесс перепрошивки клавиатуры Corne (ZMK - bluetooth) для назначения клавиш
- Цель-максимум: наладить работу с ZMK Studio, чтобы иметь возможность настраивать кнопки в "горячем" режиме

# Контекст

- MacOS
- Клавиатура - Corne, bluetooth, контроллеры pro micro NRF 52840 - аналог nice nano
- Прошивки в /clear_firmware и /factory_firmware гарантированно работают
- Для назначения клавиш используется https://nickcoutsos.github.io/keymap-editor/
    - он подключен к нужным репозиториям Github
- Репозитории - публичные форки от рекомендованных продавцов, ни один пока не работает.
    - 1 – Из последних рекомендаций https://github.com/ladkin/zmk-config-corne
    - 2 – Из предпоследних рекомендаций https://github.com/ladkin/zmk-config
    - Github Actions и необходимые права настроены корректно, сборка стартует, но не завершается успешно

# Текущая проблема и воспроизведение

- Делаю настройки в keymap editor, сохраняю их в выбранном репозитории/ ветке
- Запускается сборка билда
- В случае репо 1 - сборка успешна, но после заливки на клавиатуру она не находится среди BT устройств
- В случае репо 2 - сборка падает с ошибкой

# Доп инфо про сброс настроек

Если вы прошили settings_reset-nice_nano-zmk.uf2, то клавиатура не будет видна в Bluetooth! Это сделано специально — в settings reset firmware Bluetooth отключен, чтобы половинки не переспарились автоматически во время сброса.

# Дополнительные настройки для улучшения Bluetooth

Попробуйте добавить в config/corne.conf:

# Экспериментальные настройки для стабильности соединения
CONFIG_ZMK_BLE_EXPERIMENTAL_CONN=y

# Управление профилями (5 по умолчанию)
CONFIG_BT_MAX_CONN=6
CONFIG_BT_MAX_PAIRED=6

ZMK рекомендует сначала тестировать с телефоном (Android/iOS), так как BLE на мобильных устройствах работает стабильнее чем на десктопах (Windows/macOS/Linux).

Ключевая находка — в ZMK main (Zephyr 4.1) произошли большие изменения в определениях плат. Прошивка продавца была собрана на старой стабильной версии. Давай
  закрепим ZMK на v0.2.1 (последний релиз до Zephyr 4.1) и используем nice_nano_v2 — именно так было у продавца.